title(main = '',
xlab = expression(paste('Wave number (cm'^'-1',')')),
ylab = 'Absorbance (a.u.)')
leavesSiSpectra <- as.matrix(leavesSiSpectra)
SiTable <- data.frame(Si = I(metadata.leaves.Si$Si),spectra = I(leavesSiSpectra) )
library(pls)
SiPLS <- plsr(SiTable$Si~ leavesSiSpectra,
ncomp = 10,
data = SiTable,
validation = 'LOO')
plot(RMSEP(SiPLS),type="b",legendpos="topright")
plot(SiPLS,ncomp=5,line=TRUE)
any(SiTable$Si<0)
plot(SiPLS,plottype="scores",comps=1:4)
barplot(explvar(SiPLS)[1:4])
any(leavesSiSpectra < 0)
library(subselect)
Hmat <- lmHmat(leavesSiSpectra,metadata.leaves.Si$Si)
gen <- genetic(Hmat$mat, kmin =4, kmax = 15, H= Hmat$H, r =1, crit = 'CCR12', force = T)
View(leavesSiSpectra[,gen$bestsets[12,]])
negatives <- vector('list', nrow(gen$bestsets))
for(i in 1:nrow(gen$bestsets)){
df <- data.frame(leavesSiSpectra[, gen$bestsets[i,]])
has.neg <- apply(df, 2, function(col) any(col < 0))
negatives[[i]] <- which(has.neg)
}
negatives
par(mfrow=c(3,4))
for(j in 1:nrow(gen$bestsets)){
for (i in 1:length(rownames(leavesSiSpectra))){
plot(as.numeric(colnames(leavesSiSpectra)),
leavesSiSpectra[i,],
xlab = '',
ylab = '',
axes = F,
type = 'l',
xlim = c(1700,400),
ylim = c(0,0.06))
par(new = T)
}
box()
axis(1)
axis(2)
title(main = '',
xlab = expression(paste('Wave number (cm'^'-1',')')),
ylab = 'Absorbance (a.u.)')
abline(h = as.numeric(colnames(leavesSiSpectra)[gen$bestsets[i,]]),
col = 2,
lty = 2)
par(mfrow=c(3,4))
for(j in 1:nrow(gen$bestsets)){
for (i in 1:length(rownames(leavesSiSpectra))){
plot(as.numeric(colnames(leavesSiSpectra)),
leavesSiSpectra[i,],
xlab = '',
ylab = '',
axes = F,
type = 'l',
xlim = c(1700,400),
ylim = c(0,0.06))
par(new = T)
}
box()
axis(1)
axis(2)
title(main = '',
xlab = expression(paste('Wave number (cm'^'-1',')')),
ylab = 'Absorbance (a.u.)')
abline(h = as.numeric(colnames(leavesSiSpectra)[gen$bestsets[i,]]),
col = 2,
lty = 2)
}
par(mfrow=c(3,4))
for(j in 1:nrow(gen$bestsets)){
for (i in 1:length(rownames(leavesSiSpectra))){
plot(as.numeric(colnames(leavesSiSpectra)),
leavesSiSpectra[i,],
xlab = '',
ylab = '',
axes = F,
type = 'l',
xlim = c(1700,400),
ylim = c(0,0.06))
par(new = T)
}
box()
axis(1)
axis(2)
title(main = '',
xlab = expression(paste('Wave number (cm'^'-1',')')),
ylab = 'Absorbance (a.u.)')
abline(h = as.numeric(colnames(leavesSiSpectra)[gen$bestsets[j,]]),
col = 2,
lty = 2)
}
+par(mfrow=c(3,4))
par(mfrow=c(3,4))
for(j in 1:nrow(gen$bestsets)){
for (i in 1:length(rownames(leavesSiSpectra))){
plot(as.numeric(colnames(leavesSiSpectra)),
leavesSiSpectra[i,],
xlab = '',
ylab = '',
axes = F,
type = 'l',
xlim = c(1700,400),
ylim = c(0,0.06))
par(new = T)
}
box()
axis(1)
axis(2)
title(main = paste(as.character(c(4:15)[j]),'variables'),
xlab = expression(paste('Wave number (cm'^'-1',')')),
ylab = 'Absorbance (a.u.)')
abline(v = as.numeric(colnames(leavesSiSpectra)[gen$bestsets[j,]]),
col = 2,
lty = 2)
}
View(gen)
0.96*nrow(leavesSiSpectra)
nrow(leavesSiSpectra)
summary(mols)
mols <- lm(metadata.leaves.Si$Si ~ leavesSiSpectra[,gen$bestsets[1,]], y = T, x = T)
summary(mols)
mols <- lm(metadata.leaves.Si$Si ~ leavesSiSpectra[,gen$bestsets[5,]], y = T, x = T)
summary(mols)
mols <- lm(metadata.leaves.Si$Si ~ leavesSiSpectra[,gen$bestsets[5,][c(2,3,6)]], y = T, x = T)
summary(mols)
gen$bestsets[5,][c(2,3,6)]
colnames(leavesSiSpectra)[gen$bestsets[5,][c(2,3,6)]]
mols <- lm(metadata.leaves.Si$Si ~ leavesSiSpectra[,gen$bestsets[5,]], y = T, x = T)
summary(mols)
library(pls)
SiPLSgen <- plsr(SiTable$Si~ leavesSiSpectra[,gen$bestsets[5,]], ncomp = 10,
data = SiTable,
validation = 'LOO')
library(pls)
SiPLSgen <- plsr(SiTable$Si~ leavesSiSpectra[,gen$bestsets[5,]],
data = SiTable,
validation = 'LOO')
plot(RMSEP(SiPLSgen),type="b",legendpos="topright")
plot(SiPLS,ncomp=10,line=TRUE)
predictions8Var <- predict(mols,  newdata = SiTable)
predictions8Var[,1,1]
predictions8Var
predictions8Var <- predict(mols,  newdata = SiTable)
predX8Var <- SiTable$Si
predY8var <- predictions8Var
table8bar <- data.frame(I( predX8Var),I(predY8var))
lm.C <- lm(predX8Var~predY8var)
sum(lm.C)
summary(lm.C)
predictions8Var <- predict(mols,  newdata = SiTable)
predX8Var <- SiTable$Si
predY8var <- predictions8Var
table8bar <- data.frame(I( predX8Var),I(predY8var))
lm.C <- lm(predX8Var~predY8var)
plot(predX8Var,
predY8var,
xlab="Si real (ppm)" ,
ylab="Si predicho (ppm)",
pch=17,
cex=1.2,
col="darkorchid4",
cex.lab=1
)
abline(a=-5.856e-10  , b=1, col=1, lty=1, lwd=2)
# legend("topleft", recta.restado, pch=pch ,col=colfin, cex=1)
mols <- lm(metadata.leaves.Si$Si ~ leavesSiSpectra[,gen$bestsets[12,]], y = T, x = T)
predictions8Var <- predict(mols,  newdata = SiTable)
predX8Var <- SiTable$Si
predY8var <- predictions8Var
table8bar <- data.frame(I( predX8Var),I(predY8var))
lm.C <- lm(predX8Var~predY8var)
plot(predX8Var,
predY8var,
xlab="Si real (ppm)" ,
ylab="Si predicho (ppm)",
pch=17,
cex=1.2,
col="darkorchid4",
cex.lab=1
)
abline(a=-5.856e-10  , b=1, col=1, lty=1, lwd=2)
# legend("topleft", recta.restado, pch=pch ,col=colfin, cex=1)
mols <- lm(metadata.leaves.Si$Si ~ leavesSiSpectra[,gen$bestsets[11,]], y = T, x = T)
mols <- lm(metadata.leaves.Si$Si ~ leavesSiSpectra[,gen$bestsets[10,]], y = T, x = T)
summary(mols)
predictions8Var <- predict(mols,  newdata = SiTable)
predX8Var <- SiTable$Si
predY8var <- predictions8Var
table8bar <- data.frame(I( predX8Var),I(predY8var))
lm.C <- lm(predX8Var~predY8var)
plot(predX8Var,
predY8var,
xlab="Si real (ppm)" ,
ylab="Si predicho (ppm)",
pch=17,
cex=1.2,
col="darkorchid4",
cex.lab=1
)
abline(a=-5.856e-10  , b=1, col=1, lty=1, lwd=2)
# legend("topleft", recta.restado, pch=pch ,col=colfin, cex=1)
View(metadata)
View(metadata.leaves)
View(metadata.leaves.Si)
View(metadata.leaves.Si)
colnames(leavesSiSpectra)
nuevoRango <-   leavesSiSpectra[,c(261:676)]
library(pls)
SiPLS <- plsr(SiTable$Si~ nuevoRango,
ncomp = 10,
data = SiTable,
validation = 'LOO')
plot(SiPLS,ncomp=5,line=TRUE)
library(pls)
SiPLS <- plsr(SiTable$Si~ nuevoRango,
ncomp = 10,
data = SiTable,
validation = 'LOO')
plot(RMSEP(SiPLS),type="b",legendpos="topright")
plot(SiPLS,ncomp=4,line=TRUE)
plot(SiPLS,plottype="scores",comps=1:4)
barplot(explvar(SiPLS)[1:4])
View(gen)
View(leavesSiSpectra[,gen$bestsets[12,]])
mols <- lm(metadata.leaves.Si$Si ~ leavesSiSpectra[,gen$bestsets[12,]], y = T, x = T)
summary(mols)
predictions8Var <- predict(mols,  newdata = SiTable)
predX8Var <- SiTable$Si
predY8var <- predictions8Var
table8bar <- data.frame(I( predX8Var),I(predY8var))
lm.C <- lm(predX8Var~predY8var)
plot(predX8Var,
predY8var,
xlab="Si real (ppm)" ,
ylab="Si predicho (ppm)",
pch=17,
cex=1.2,
col="darkorchid4",
cex.lab=1
)
abline(a=-5.856e-10  , b=1, col=1, lty=1, lwd=2)
# legend("topleft", recta.restado, pch=pch ,col=colfin, cex=1)
library(pls)
SiPLSgen <- plsr(SiTable$Si~ leavesSiSpectra[,gen$bestsets[5,]],
data = SiTable,
validation = 'LOO')
plot(RMSEP(SiPLSgen),type="b",legendpos="topright")
library(pls)
SiPLSgen <- plsr(SiTable$Si~ leavesSiSpectra[,gen$bestsets[12,]],
data = SiTable,
validation = 'LOO')
plot(RMSEP(SiPLSgen),type="b",legendpos="topright")
plot(SiPLS,ncomp=3,line=TRUE)
plot(SiPLS,ncomp=4,line=TRUE)
plot(SiPLS,ncomp=15,line=TRUE)
plot(SiPLS,ncomp=10,line=TRUE)
mols <- lm(metadata.leaves.Si$Si ~ leavesSiSpectra[,gen$bestsets[1,]], y = T, x = T)
summary(mols)
predictions8Var <- predict(mols,  newdata = SiTable)
predX8Var <- SiTable$Si
predY8var <- predictions8Var
table8bar <- data.frame(I( predX8Var),I(predY8var))
lm.C <- lm(predX8Var~predY8var)
plot(predX8Var,
predY8var,
xlab="Si real (ppm)" ,
ylab="Si predicho (ppm)",
pch=17,
cex=1.2,
col="darkorchid4",
cex.lab=1
)
abline(a=-5.856e-10  , b=1, col=1, lty=1, lwd=2)
# legend("topleft", recta.restado, pch=pch ,col=colfin, cex=1)
mols <- lm(metadata.leaves.Si$Si ~ leavesSiSpectra[,gen$bestsets[2,]], y = T, x = T)
summary(mols)
predictions8Var <- predict(mols,  newdata = SiTable)
predX8Var <- SiTable$Si
predY8var <- predictions8Var
table8bar <- data.frame(I( predX8Var),I(predY8var))
lm.C <- lm(predX8Var~predY8var)
plot(predX8Var,
predY8var,
xlab="Si real (ppm)" ,
ylab="Si predicho (ppm)",
pch=17,
cex=1.2,
col="darkorchid4",
cex.lab=1
)
abline(a=-5.856e-10  , b=1, col=1, lty=1, lwd=2)
# legend("topleft", recta.restado, pch=pch ,col=colfin, cex=1)
colnames(leavesSiSpectra)[gen$bestsets[3,]]
mols <- lm(metadata.leaves.Si$Si ~ leavesSiSpectra[,gen$bestsets[3,]], y = T, x = T)
summary(mols)
predictions8Var <- predict(mols,  newdata = SiTable)
predX8Var <- SiTable$Si
predY8var <- predictions8Var
table8bar <- data.frame(I( predX8Var),I(predY8var))
lm.C <- lm(predX8Var~predY8var)
plot(predX8Var,
predY8var,
xlab="Si real (ppm)" ,
ylab="Si predicho (ppm)",
pch=17,
cex=1.2,
col="darkorchid4",
cex.lab=1
)
abline(a=-5.856e-10  , b=1, col=1, lty=1, lwd=2)
# legend("topleft", recta.restado, pch=pch ,col=colfin, cex=1)
colnames( leavesSiSpectra[,c(261:676)])
colnames( leavesSiSpectra[,c(261,676)])
library(pls)
SiPLS <- plsr(SiTable$Si~ nuevoRango,
ncomp = 10,
data = SiTable,
validation = 'LOO')
View(SiPLS)
install.packages(DAAG)
install.packages('DAAG')
View(leavesSiSpectra[,gen$bestsets[12,]])
plot(SiPLS,ncomp=4,line=TRUE)
View(SiTable)
predictions8Var <- predict(mols,  newdata = leavesSiSpectra[,gen$bestsets[3,]])
predX8Var <- SiTable$Si
predictions8Var <- predict(mols,  newdata = as.data.frame(leavesSiSpectra[,gen$bestsets[3,]))
predictions8Var <- predict(mols,  newdata = as.data.frame(leavesSiSpectra[,gen$bestsets[3,]]))
predX8Var <- SiTable$Si
predY8var <- predictions8Var
table8bar <- data.frame(I( predX8Var),I(predY8var))
lm.C <- lm(predX8Var~predY8var)
plot(predX8Var,
predY8var,
xlab="Si real (ppm)" ,
ylab="Si predicho (ppm)",
pch=17,
cex=1.2,
col="darkorchid4",
cex.lab=1
)
abline(a=-5.856e-10  , b=1, col=1, lty=1, lwd=2)
abline(a=-5.856e-10  , b=1, col=1, lty=1, lwd=2)
plot(predX8Var,
predY8var,
xlab="Si real (ppm)" ,
ylab="Si predicho (ppm)",
pch=17,
cex=1.2,
col="darkorchid4",
cex.lab=1
)
abline(a=-5.856e-10  , b=1, col=1, lty=1, lwd=2)
predictions8Var <- predict(mols,  newdata = as.data.frame(leavesSiSpectra[,gen$bestsets[3,]]))
predX8Var <- SiTable$Si
predY8var <- predictions8Var
table8bar <- data.frame(I( predX8Var),I(predY8var))
lm.C <- lm(predX8Var~predY8var)
plot(predX8Var,
predY8var,
xlab="Si real (ppm)" ,
ylab="Si predicho (ppm)",
pch=17,
cex=1.2,
col="darkorchid4",
cex.lab=1
)
abline(a=-5.856e-10  , b=1, col=1, lty=1, lwd=2)
# legend("topleft", recta.restado, pch=pch ,col=colfin, cex=1)
predictions8Var <- predict(mols,  newdata = as.data.frame(leavesSiSpectra[,gen$bestsets[3,]]))
predX8Var <- SiTable$Si
predY8var <- predictions8Var
table8bar <- data.frame(I( predX8Var),I(predY8var))
lm.C <- lm(predX8Var~predY8var)
plot(predX8Var,
predY8var,
xlab="Si real (ppm)" ,
ylab="Si predicho (ppm)",
pch=17,
cex=1.2,
col="darkorchid4",
cex.lab=1
)
abline(a=-5.856e-10  , b=1, col=1, lty=1, lwd=2)
predictions8Var <- predict(mols,  newdata = as.data.frame(leavesSiSpectra[,gen$bestsets[3,]]))
predX8Var <- SiTable$Si
predY8var <- predictions8Var
table8bar <- data.frame(I( predX8Var),I(predY8var))
lm.C <- lm(predX8Var~predY8var)
plot(predX8Var,
predY8var,
xlab="Si real (ppm)" ,
ylab="Si predicho (ppm)",
pch=17,
cex=1.2,
col="darkorchid4",
cex.lab=1
)
abline(a=-5.856e-10  , b=1, col=1, lty=1, lwd=2)
# legend("topleft", recta.restado, pch=pch ,col=colfin, cex=1)
mols <- lm(metadata.leaves.Si$Si ~ leavesSiSpectra[,gen$bestsets[3,]], y = T, x = T)
predictions8Var <- predict(mols,  newdata = as.data.frame(leavesSiSpectra[,gen$bestsets[3,]]))
predX8Var <- SiTable$Si
predY8var <- predictions8Var
table8bar <- data.frame(I( predX8Var),I(predY8var))
lm.C <- lm(predX8Var~predY8var)
plot(predX8Var,
predY8var,
xlab="Si real (ppm)" ,
ylab="Si predicho (ppm)",
pch=17,
cex=1.2,
col="darkorchid4",
cex.lab=1
)
abline(a=-5.856e-10  , b=1, col=1, lty=1, lwd=2)
# legend("topleft", recta.restado, pch=pch ,col=colfin, cex=1)
View(SiTable)
View(SiTable)
SiTablegen <- cbind(metadata.leaves.Si$Si,
leavesSiSpectra[,gen$bestsets[3,]])
View(SiTablegen)
colnames(SiTablegen)[1] <- 'Si'
View(SiTablegen)
library(DAAG)
SiTablegen <- cbind(metadata.leaves.Si$Si,
leavesSiSpectra[,gen$bestsets[3,]])
colnames(SiTablegen)[1] <- 'Si'
cv.lm(df = SiTablegen,
form.lm = formula(Si~.),
m = 23,
seed = 1)
SiTablegen <- cbind(metadata.leaves.Si$Si,
leavesSiSpectra[,gen$bestsets[3,]])
colnames(SiTablegen)[1] <- 'Si'
cv.lm(df = SiTablegen,
form.lm = formula(Si~.),
m = 23,
seed = 1)
?cv.lm
library(DAAG)
SiTablegen <- cbind(metadata.leaves.Si$Si,
leavesSiSpectra[,gen$bestsets[3,]])
colnames(SiTablegen)[1] <- 'Si'
cv.lm(data = SiTablegen,
form.lm = formula(Si~.),
m = 23,
seed = 1)
library(DAAG)
SiTablegen <- data.frame(cbind(metadata.leaves.Si$Si,
leavesSiSpectra[,gen$bestsets[3,]]))
colnames(SiTablegen)[1] <- 'Si'
cv.lm(data = SiTablegen,
form.lm = formula(Si~.),
m = 23,
seed = 1)
SiCVgenmols <-  cv.lm(data = SiTablegen,
form.lm = formula(Si~.),
m = 23,
seed = 1)
predictions8Var <- predict(mols,  newdata = as.data.frame(leavesSiSpectra[,gen$bestsets[3,]]))
predX8Var <- SiTable$Si
predY8var <- predictions8Var
table8bar <- data.frame(I( predX8Var),I(predY8var))
lm.C <- lm(predX8Var~predY8var)
plot(predX8Var,
predY8var,
xlab="Si real (ppm)" ,
ylab="Si predicho (ppm)",
pch=17,
cex=1.2,
col="darkorchid4",
cex.lab=1
)
abline(a=-5.856e-10  , b=1, col=1, lty=1, lwd=2)
# legend("topleft", recta.restado, pch=pch ,col=colfin, cex=1)
mols <- glm(metadata.leaves.Si$Si ~ leavesSiSpectra[,gen$bestsets[3,]], y = T, x = T)
summary(mols)
z`?glm`
`?glm`
?glm
library(lmvar)
?lmvar::cv.lm
predictions8Var <- predict(mols,  newdata = as.data.frame(leavesSiSpectra[,gen$bestsets[3,]]))
predX8Var <- SiTable$Si
predY8var <- predictions8Var
table8bar <- data.frame(I( predX8Var),I(predY8var))
lm.C <- lm(predX8Var~predY8var)
plot(predX8Var,
predY8var,
xlab="Si real (ppm)" ,
ylab="Si predicho (ppm)",
pch=17,
cex=1.2,
col="darkorchid4",
cex.lab=1
)
abline(a=-5.856e-10  , b=1, col=1, lty=1, lwd=2)
# legend("topleft", recta.restado, pch=pch ,col=colfin, cex=1)
mols <- lm(metadata.leaves.Si$Si ~ leavesSiSpectra[,gen$bestsets[3,]], y = T, x = T)
summary(mols)
cv.lm(mols,
k=23)
dimnames(mols)
dimnames(mols)[2]
str(mols)
View(mols)
?lmvar
